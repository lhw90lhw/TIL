## 10/17(월)

---

[WG]

[Morning]

- Nest 프로젝트 AWS Lambda에 올려보기.
- 기존 프로젝트 Nest 씌워서 API 1개만 돌려보고 다음주 월요일에 배포 가능한 일정 산출하기.
- typescript 배포 시 dist에 떨어진 파일(js, js.map, d.ts .. 등) 다 올려야 하는지 Check

## TypeScript AWS Lambda Deploy

    - https://blog.appsignal.com/2022/09/21/how-to-build-aws-lambdas-with-typescript.html
    - Claudia는 AWS Lambda 및 API Gateway에 프로젝트를 쉽게 배포할 수 있게 해주는 서버리스 도구

## NestJS AWS Lambda Deploy

    - https://dev.to/aws-builders/deploy-a-nestjs-api-to-aws-lambda-with-serverless-framework-4poo

## AWS Lambda

- Account

| User name | Access key ID        | Secret access key                        | Console login link                                 |
| --------- | -------------------- | ---------------------------------------- | -------------------------------------------------- |
| kyle      | AKIA4GJUZYWKURLO26EM | tjkoZbuxcwv+nLkJU59MS07OKFTg+HCJBSW2ACe9 | https://838166234517.signin.aws.amazon.com/console |

- Getting-started (run-serverless-code)
  - https://aws.amazon.com/ko/getting-started/hands-on/run-serverless-code/

## NCIS

- 52 : 유전자치료제
- 70 : 세포 유전자치료제

## AWS_Zip-File_Deploy

- https://docs.aws.amazon.com/ko_kr/lambda/latest/dg/configuration-function-zip.html

## AWS CloudFormation

-

[Afternoon]

## 프로비저닝이란?

    - https://www.redhat.com/ko/topics/automation/what-is-provisioning
    - IT 인프라를 설정하는 프로세스로, 사용자와 시스템에서 사용할 수 있도록, 데이터와 리소스에 대한 액세스를 관리하는 데 필요한 단계
    - 프로비저닝과 설정은 다른 작업이지만, 둘 다 배포 프로세스의 단계에 포함된다.
    - 종류
        - 서버 프로비저닝
        - 네트워크 프로비저닝
        - 사용자 프로비저닝
        - 서비스 프로비저닝

- Error:

  1. Serverless plugin "serverless-domain-manager" not found. Make sure it's installed and listed in the "plugins" section of your serverless config file. Run "serverless plugin install -n serverless-domain-manager" to install it.

  2. serverless.yml 의 주석처리를 잘못함.
     - custom/customDomain은 required option이다.
       이 값들을 아래와 같이 주석처리해주면서 발생.

  ```
      # custom:
      # customDomain:
          # domainName: negociant.nventure.co.kr
          # basePath: ""
          # stage: ${self:provider.stage}
          # createRoute53Record: true
  ```

## serverless deploy

- 명령어 실행 시 아래와 같은 리소스가 터미널로 반환

```
Warning: Invalid configuration encountered
  at 'functions.api.events.0.http': value 'ANY {proxy+}' does not satisfy pattern /^(?:\*|(GET|POST|PUT|PATCH|OPTIONS|HEAD|DELETE|ANY) (\/\S*))$/i

Learn more about configuration validation here: http://slss.io/configuration-validation

Deploying nest-negociant to stage prod (ap-northeast-2)

✔ Service deployed to stack nest-negociant (51s)

endpoint: ANY - https://a3vuasiv7h.execute-api.ap-northeast-2.amazonaws.com/prod/{proxy+}
functions:
  api: nest-negociant-api (40 MB)

2 deprecations found: run 'serverless doctor' for more details

Monitor all your API routes with Serverless Console: run "serverless --console"
```

- Install serverless-typescript

  - sudo npm i serverless-plugin-typescript -g

- Install serverless-offline

  - sudo npm i serverless-offline -g

- serverless 공홈

  - https://www.serverless.com/framework/docs/providers/aws/guide/variables/

- TypeError: Cannot read property 'getLineAndCharacterOfPosition' of undefined

  - tsconfig.json 에서 "incremental": true,를 제거

- Error 원인 제거
  - function api events 변경
    - - http: ANY {proxy+} => ANY /{proxy+}

```
    Warning: Invalid configuration encountered
  at 'functions.api.events.0.http': value 'ANY/{proxy+}' does not satisfy pattern /^(?:\*|(GET|POST|PUT|PATCH|OPTIONS|HEAD|DELETE|ANY) (\/\S*))$/i
```

---

[PG]

- 아작습
